RUNTIME SECRETS HYGIENE SCAN
Date: 2026-01-18 15:08:59
Scope: Runtime source code (excluding docs/reports/node_modules)

SEARCH PATTERNS:
- JWT_SECRET literals
- API_KEY literals
- "change-in-production"
- "dev-secret"
- "myid-api-key"
- Direct process.env.JWT_SECRET/API_KEY usage as values

FINDINGS:

1. Backend routes (myid-app/backend/routes/*.mjs):
   STATUS: CLEAN
   All routes use getBackendSecrets() from Vault
   No hardcoded secrets found
   Files checked:
   - auth.mjs
   - passkey.mjs
   - user.mjs
   - mastercode.mjs
   - trustcode.mjs
   - mdl.mjs
   - consent.mjs
   - credentials.mjs
   - qes.mjs

2. PWA Server (/perform1/srv/work/www/html/myid/pwa-app/server/index.js):
   STATUS: PATCHED
   Original issue: Hardcoded fallback 'dev-secret-change-in-production'
   Fix applied: Require SESSION_SECRET from environment, throw error if missing
   Location: Line 70
   Commit: Pending

3. Agent scripts and fixpack:
   STATUS: EXCLUDED (not runtime code)
   Found references in:
   - agents/agents/07-runtime-config-agent.mjs (test patterns)
   - agents/crypto-pack/agent2-vault-hardening.mjs (scan definitions)
   - fixpack/agents/*.mjs (remediation scripts)

CONCLUSION: CLEAN
All runtime code now requires secrets from environment/Vault.
No hardcoded secrets remain in production runtime paths.
